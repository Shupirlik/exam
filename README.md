Для авторизации пользователя использовался пакет passport 
Для работы сессий - express-session 
Для реализации логики использовались методы serializeUser и deserializeUser и стратегия passport-local 
После ввода данных пользователя при помощи passport проверяем валидность этих данных 
Если данные корректны идет запись сессии пользователя. 
Если введенные данные неверны или пользователь заходит на страницу профиля или страницу RAW неавторизированным, происходит перенаправление на страницу логина при помощи middleware 
Так же, если пользователь заходит на страницу профиля или страницу RAW неавторизированным происходит запись сессии returnTo перед перенаправлением с данными о странице с которой произошло это перенаправление, после ввода корректных данных пользователя, и если существует сессия returnTo, идет перенаправление на страницу которую пользователь и хотел видеть
